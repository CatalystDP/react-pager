(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("react"), require("react-dom"));
	else if(typeof define === 'function' && define.amd)
		define(["react", "react-dom"], factory);
	else if(typeof exports === 'object')
		exports["Pager"] = factory(require("react"), require("react-dom"));
	else
		root["Pager"] = factory(root["react"], root["react-dom"]);
})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }
	
	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }
	
	var React = __webpack_require__(1);
	var ReactDOM = __webpack_require__(2);
	var util = {
	    extend: function extend(target) {
	        for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
	            args[_key - 1] = arguments[_key];
	        }
	
	        for (var i = 0, len = args.length; i < len; ++i) {
	            for (var key in args[i]) {
	                target[key] = args[i][key];
	            }
	        }
	    },
	    is: function is(obj, type) {
	        return Object.prototype.toString.call(obj).split(' ')[1].substr(-20).replace(']', '').toLowerCase() === type;
	    },
	    isObject: function isObject(obj) {
	        return util.is(obj, 'object');
	    },
	    isArray: function isArray(obj) {
	        return util.is(obj, 'array');
	    },
	    isFunction: function isFunction(obj) {
	        return util.is(obj, 'function');
	    },
	
	    css: {
	        addClass: function addClass(element, className) {
	            if (className) {
	                if (element.classList) {
	                    element.classList.add(className);
	                } else if (!util.css.hasClass(element, className)) {
	                    element.className = element.className + ' ' + className;
	                }
	            }
	            return element;
	        },
	        removeClass: function removeClass(element, className) {
	            if (className) {
	                if (element.classList) {
	                    element.classList.remove(className);
	                } else if (util.css.hasClass(element, className)) {
	                    element.className = element.className.replace(new RegExp('(^|\\s)' + className + '(?:\\s|$)', 'g'), '$1').replace(/\s+/g, ' ') // multiple spaces to one
	                    .replace(/^\s*|\s*$/g, ''); // trim the ends
	                }
	            }
	            return element;
	        },
	        hasClass: function hasClass(element, className) {
	            if (element.classList) {
	                return !!className && element.classList.contains(className);
	            }
	            return (' ' + element.className + ' ').indexOf(' ' + className + ' ') > -1;
	        }
	    }
	};
	/**
	 *
	 * @type {{INIT: number, TONEW: number, TOOLD: number}}
	 * 0 means init
	 */
	var DIRECTION = {
	    INIT: 0,
	    TONEW: -1,
	    TOOLD: 1
	};
	
	var PagerError = function (_Error) {
	    _inherits(PagerError, _Error);
	
	    function PagerError(message) {
	        _classCallCheck(this, PagerError);
	
	        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(PagerError).call(this, message));
	
	        _this.name = 'PagerError';
	        return _this;
	    }
	
	    return PagerError;
	}(Error);
	
	/**
	 *
	 * @param opts
	 *      @param [opts.animation] 当enableAnimation=true并且传入了transitionGroup有效
	 *             @param [opts.animation.beforeEnter(el,direction,page)]
	 *             @param [opts.animation.enter(el,direction,callback,page)]动画结束后要调用callback
	 *             @param [opts.animation.afterenter(el,direction,page)]
	 *             @param [opts.animation.beforeLeave(el,direction,page)]
	 *             @param [opts.animation.leave(el,direction,callback,page)]动画结束后要调用callback
	 *             @param [opts.animation.afterLeave(el,direction,page)]
	 *      @param [opts.enableAnimation] true表示使用动画
	 *      **** enableAnimation=true && 传入了cssTransitionGroup 情况下传 ****
	 *      @param css css类名对象
	 *             [css.transition] 用来执行过渡的类名可以放入transision必需的css属性
	 *             css.forward 正向css类名 需要实现类名 xxx-enter xxx-enter-active xxx-leave xxx-leave-active
	 *             css.backward 反向css类名 名称规则同css.forward
	 *      @param duration 动画持续时间 单位 ms
	 *      ****************************************
	 * @description 
	 *              动画钩子内的direction是用来判断页面切换的方向的 TOOLD表示老的页面要出来了 TONEW表示新页面要进来，INIT 表示初始化
	 * @returns {*}
	 */
	
	
	function createPager() {
	    var opts = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];
	
	    if (opts.animation && !(opts.transitionGroup || opts.cssTransitionGroup)) {
	        throw new PagerError('you should provide ReactTransitionGroup to transitionGroup option');
	    }
	    var TransitionGroup = opts.transitionGroup;
	    var CssTransitionGroup = opts.cssTransitionGroup;
	    var css = opts.css || {};
	    var animationObj = opts.animation || {};
	    var duration = typeof opts.duration != 'undefined' ? opts.duration : 300;
	    var direction = DIRECTION.INIT;
	    var lockTarget = opts.lockTarget || document.getElementsByTagName('body')[0]; //默认锁body元素
	    var Container = React.createClass({
	        displayName: 'Container',
	
	        name: 'Container',
	        componentWillMount: function componentWillMount() {},
	        componentDidMount: function componentDidMount() {
	            var page = this.props.page;
	            this.el = ReactDOM.findDOMNode(this);
	            util.isFunction(animationObj.beforeEnter) && opts.enableAnimation && animationObj.beforeEnter(this.el, direction, page);
	        },
	        componentWillEnter: function componentWillEnter(done) {
	            var _this2 = this;
	
	            var page = this.props.page;
	            var _done2 = function _done() {
	                _done2 = null;
	                done();
	                util.isFunction(animationObj.afterEnter) && animationObj.afterEnter(_this2.el, direction, page);
	            };
	            if (util.isFunction(animationObj.enter)) {
	                animationObj.enter(this.el, direction, _done2, page);
	            } else {
	                _done2();
	            }
	        },
	        componentWillUnmount: function componentWillUnmount() {
	            var page = this.props.page;
	            util.isFunction(animationObj.afterLeave) && opts.enableAnimation && animationObj.afterLeave(this.el, direction, page);
	        },
	        componentWillLeave: function componentWillLeave(done) {
	            var page = this.props.page;
	            util.isFunction(animationObj.beforeLeave) && animationObj.beforeLeave(this.el, direction, page);
	            util.isFunction(animationObj.leave) ? animationObj.leave(this.el, direction, done, page) : done();
	        },
	        render: function render() {
	            return React.createElement(
	                'div',
	                { style: this.props.style, className: this.props.className },
	                this.props.children
	            );
	        }
	    });
	    var Pager = React.createClass({
	        displayName: 'Pager',
	
	        name: 'Pager',
	        getInitialState: function getInitialState() {
	            this.stack = [];
	            return { page: null, component: null };
	        },
	        componentDidMount: function componentDidMount() {
	            this._changePage(this.props.page);
	        },
	        shouldComponentUpdate: function shouldComponentUpdate(nextProps, nextState) {
	            return this._changePage(nextState.page || nextProps.page);
	        },
	        switchPage: function switchPage(page, component) {
	            this.setState({
	                page: page,
	                component: component
	            });
	        },
	        _changePage: function _changePage(page) {
	            var len = this.stack.length;
	            if (this.stack[len - 1] == page) return false;
	            var index = this.stack.indexOf(page);
	            if (index != -1) {
	                this.stack.splice(index + 1);
	                direction = DIRECTION.TOOLD; //old will display
	            } else {
	                this.stack.push(page);
	                //新的出现
	                direction = DIRECTION.TONEW;
	                if (this.stack.length <= 1) {
	                    direction = DIRECTION.INIT;
	                }
	            }
	            return true;
	        },
	        render: function render() {
	            var Component = this.props.component;
	            var style = {
	                width: '100%',
	                height: '100%',
	                left: 0,
	                right: 0,
	                position: 'absolute'
	            };
	            if (this.props.style) {
	                util.extend(style, this.props.style);
	            }
	            var child = React.createElement(
	                Container,
	                { key: this.props.page, page: this.props.page,
	                    style: style, className: css.transition || '' },
	                Component
	            );
	            if (opts.enableAnimation) {
	                if (CssTransitionGroup) {
	                    var className = void 0;
	                    if (direction == DIRECTION.TONEW) {
	                        className = css.forward;
	                    } else if (direction == DIRECTION.TOOLD) {
	                        className = css.backward;
	                    } else {
	                        className = '';
	                    }
	                    return React.createElement(
	                        CssTransitionGroup,
	                        { component: 'div', transitionName: className,
	                            transitionEnterTimeout: duration, transitionLeaveTimeout: duration },
	                        child
	                    );
	                } else if (TransitionGroup) {
	                    return React.createElement(
	                        TransitionGroup,
	                        { component: 'div', style: style },
	                        child
	                    );
	                } else {
	                    return Component;
	                }
	            } else {
	                return Component;
	            }
	        }
	    });
	    Pager.lock = function () {
	        if (direction == DIRECTION.INIT) {
	            Pager.unlock();
	            return;
	        }
	        lockTarget.style.pointerEvents = 'none';
	    };
	    Pager.unlock = function () {
	        lockTarget.style.pointerEvents = 'auto';
	    };
	    return Pager;
	}
	
	module.exports = {
	    createPager: createPager,
	    DIRECTION: DIRECTION
	};

/***/ },
/* 1 */
/***/ function(module, exports) {

	module.exports = __WEBPACK_EXTERNAL_MODULE_1__;

/***/ },
/* 2 */
/***/ function(module, exports) {

	module.exports = __WEBPACK_EXTERNAL_MODULE_2__;

/***/ }
/******/ ])
});
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uPzVjYTYiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIGQ3YmE3ZjczOWQ1ZjI4MWEyZThlPzMwNGEiLCJ3ZWJwYWNrOi8vLy4vc3JjL3BhZ2VyLmpzP2U3NDUiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwicmVhY3RcIj8zYzYyIiwid2VicGFjazovLy9leHRlcm5hbCBcInJlYWN0LWRvbVwiPzVlOTkiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELE87QUNWQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx1QkFBZTtBQUNmO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7QUN0Q0EsS0FBSSxRQUFRLG9CQUFRLENBQVIsQ0FBWjtBQUNBLEtBQUksV0FBVyxvQkFBUSxDQUFSLENBQWY7QUFDQSxLQUFJLE9BQU87QUFDUCxXQURPLGtCQUNBLE1BREEsRUFDZ0I7QUFBQSwyQ0FBTCxJQUFLO0FBQUwsaUJBQUs7QUFBQTs7QUFDbkIsY0FBSyxJQUFJLElBQUksQ0FBUixFQUFXLE1BQU0sS0FBSyxNQUEzQixFQUFtQyxJQUFJLEdBQXZDLEVBQTRDLEVBQUUsQ0FBOUMsRUFBaUQ7QUFDN0Msa0JBQUssSUFBSSxHQUFULElBQWdCLEtBQUssQ0FBTCxDQUFoQixFQUF5QjtBQUNyQix3QkFBTyxHQUFQLElBQWMsS0FBSyxDQUFMLEVBQVEsR0FBUixDQUFkO0FBQ0g7QUFDSjtBQUNKLE1BUE07QUFRUCxPQVJPLGNBUUosR0FSSSxFQVFDLElBUkQsRUFRTTtBQUNULGdCQUFPLE9BQU8sU0FBUCxD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TixHQUFXLFlBQUk7QUFDWCxhQUFHLGFBQVcsVUFBVSxJQUF4QixFQUE2QjtBQUN6QixtQkFBTSxNQUFOO0FBQ0E7QUFDSDtBQUNELG9CQUFXLEtBQVgsQ0FBaUIsYUFBakIsR0FBK0IsTUFBL0I7QUFDSCxNQU5EO0FBT0EsV0FBTSxNQUFOLEdBQWEsWUFBSTtBQUNiLG9CQUFXLEtBQVgsQ0FBaUIsYUFBakIsR0FBK0IsTUFBL0I7QUFDSCxNQUZEO0FBR0EsWUFBTyxLQUFQO0FBQ0g7O0FBRUQsUUFBTyxPQUFQLEdBQWlCO0FBQ2IsNkJBRGE7QUFFYjtBQUZhLEVBQWpCLEM7Ozs7OztBQ3BPQSxnRDs7Ozs7O0FDQUEsZ0QiLCJmaWxlIjoicGFnZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwicmVhY3RcIiksIHJlcXVpcmUoXCJyZWFjdC1kb21cIikpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW1wicmVhY3RcIiwgXCJyZWFjdC1kb21cIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiUGFnZXJcIl0gPSBmYWN0b3J5KHJlcXVpcmUoXCJyZWFjdFwiKSwgcmVxdWlyZShcInJlYWN0LWRvbVwiKSk7XG5cdGVsc2Vcblx0XHRyb290W1wiUGFnZXJcIl0gPSBmYWN0b3J5KHJvb3RbXCJyZWFjdFwiXSwgcm9vdFtcInJlYWN0LWRvbVwiXSk7XG59KSh0aGlzLCBmdW5jdGlvbihfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8yX18pIHtcbnJldHVybiBcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiB3ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb25cbiAqKi8iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svYm9vdHN0cmFwIGQ3YmE3ZjczOWQ1ZjI4MWEyZThlXG4gKiovIiwibGV0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcclxubGV0IFJlYWN0RE9NID0gcmVxdWlyZSgncmVhY3QtZG9tJyk7XHJcbmxldCB1dGlsID0ge1xyXG4gICAgZXh0ZW5kKHRhcmdldCwgLi4uYXJncyl7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGFyZ3MubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQga2V5IGluIGFyZ3NbaV0pIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldFtrZXldID0gYXJnc1tpXVtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGlzKG9iaiwgdHlwZSl7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopLnNwbGl0KCcgJylbMV0uc3Vic3RyKC0yMCkucmVwbGFjZSgnXScsICcnKS50b0xvd2VyQ2FzZSgpID09PSB0eXBlO1xyXG4gICAgfSxcclxuICAgIGlzT2JqZWN0KG9iail7XHJcbiAgICAgICAgcmV0dXJuIHV0aWwuaXMob2JqLCAnb2JqZWN0Jyk7XHJcbiAgICB9LFxyXG4gICAgaXNBcnJheShvYmope1xyXG4gICAgICAgIHJldHVybiB1dGlsLmlzKG9iaiwgJ2FycmF5Jyk7XHJcbiAgICB9LFxyXG4gICAgaXNGdW5jdGlvbihvYmope1xyXG4gICAgICAgIHJldHVybiB1dGlsLmlzKG9iaiwgJ2Z1bmN0aW9uJyk7XHJcbiAgICB9LFxyXG4gICAgY3NzOiB7XHJcbiAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKXtcclxuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCF1dGlsLmNzcy5oYXNDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZSArICcgJyArIGNsYXNzTmFtZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSl7XHJcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmNsYXNzTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1dGlsLmNzcy5oYXNDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoJyhefFxcXFxzKScgKyBjbGFzc05hbWUgKyAnKD86XFxcXHN8JCknLCAnZycpLCAnJDEnKS5yZXBsYWNlKC9cXHMrL2csICcgJykgLy8gbXVsdGlwbGUgc3BhY2VzIHRvIG9uZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXlxccyp8XFxzKiQvZywgJycpOyAvLyB0cmltIHRoZSBlbmRzXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBoYXNDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpe1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhIWNsYXNzTmFtZSAmJiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAoJyAnICsgZWxlbWVudC5jbGFzc05hbWUgKyAnICcpLmluZGV4T2YoJyAnICsgY2xhc3NOYW1lICsgJyAnKSA+IC0xO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqXHJcbiAqIEB0eXBlIHt7SU5JVDogbnVtYmVyLCBUT05FVzogbnVtYmVyLCBUT09MRDogbnVtYmVyfX1cclxuICogMCBtZWFucyBpbml0XHJcbiAqL1xyXG5jb25zdCBESVJFQ1RJT04gPSB7XHJcbiAgICBJTklUOiAwLFxyXG4gICAgVE9ORVc6IC0xLFxyXG4gICAgVE9PTEQ6IDFcclxufTtcclxuY2xhc3MgUGFnZXJFcnJvciBleHRlbmRzIEVycm9yIHtcclxuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcclxuICAgICAgICBzdXBlcihtZXNzYWdlKTtcclxuICAgICAgICB0aGlzLm5hbWUgPSAnUGFnZXJFcnJvcic7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKlxyXG4gKiBAcGFyYW0gb3B0c1xyXG4gKiAgICAgIEBwYXJhbSBbb3B0cy5hbmltYXRpb25dIOW9k2VuYWJsZUFuaW1hdGlvbj10cnVl5bm25LiU5Lyg5YWl5LqGdHJhbnNpdGlvbkdyb3Vw5pyJ5pWIXHJcbiAqICAgICAgICAgICAgIEBwYXJhbSBbb3B0cy5hbmltYXRpb24uYmVmb3JlRW50ZXIoZWwsZGlyZWN0aW9uLHBhZ2UpXVxyXG4gKiAgICAgICAgICAgICBAcGFyYW0gW29wdHMuYW5pbWF0aW9uLmVudGVyKGVsLGRpcmVjdGlvbixjYWxsYmFjayxwYWdlKV3liqjnlLvnu5PmnZ/lkI7opoHosIPnlKhjYWxsYmFja1xyXG4gKiAgICAgICAgICAgICBAcGFyYW0gW29wdHMuYW5pbWF0aW9uLmFmdGVyZW50ZXIoZWwsZGlyZWN0aW9uLHBhZ2UpXVxyXG4gKiAgICAgICAgICAgICBAcGFyYW0gW29wdHMuYW5pbWF0aW9uLmJlZm9yZUxlYXZlKGVsLGRpcmVjdGlvbixwYWdlKV1cclxuICogICAgICAgICAgICAgQHBhcmFtIFtvcHRzLmFuaW1hdGlvbi5sZWF2ZShlbCxkaXJlY3Rpb24sY2FsbGJhY2sscGFnZSld5Yqo55S757uT5p2f5ZCO6KaB6LCD55SoY2FsbGJhY2tcclxuICogICAgICAgICAgICAgQHBhcmFtIFtvcHRzLmFuaW1hdGlvbi5hZnRlckxlYXZlKGVsLGRpcmVjdGlvbixwYWdlKV1cclxuICogICAgICBAcGFyYW0gW29wdHMuZW5hYmxlQW5pbWF0aW9uXSB0cnVl6KGo56S65L2/55So5Yqo55S7XHJcbiAqICAgICAgKioqKiBlbmFibGVBbmltYXRpb249dHJ1ZSAmJiDkvKDlhaXkuoZjc3NUcmFuc2l0aW9uR3JvdXAg5oOF5Ya15LiL5LygICoqKipcclxuICogICAgICBAcGFyYW0gY3NzIGNzc+exu+WQjeWvueixoVxyXG4gKiAgICAgICAgICAgICBbY3NzLnRyYW5zaXRpb25dIOeUqOadpeaJp+ihjOi/h+a4oeeahOexu+WQjeWPr+S7peaUvuWFpXRyYW5zaXNpb27lv4XpnIDnmoRjc3PlsZ7mgKdcclxuICogICAgICAgICAgICAgY3NzLmZvcndhcmQg5q2j5ZCRY3Nz57G75ZCNIOmcgOimgeWunueOsOexu+WQjSB4eHgtZW50ZXIgeHh4LWVudGVyLWFjdGl2ZSB4eHgtbGVhdmUgeHh4LWxlYXZlLWFjdGl2ZVxyXG4gKiAgICAgICAgICAgICBjc3MuYmFja3dhcmQg5Y+N5ZCRY3Nz57G75ZCNIOWQjeensOinhOWImeWQjGNzcy5mb3J3YXJkXHJcbiAqICAgICAgQHBhcmFtIGR1cmF0aW9uIOWKqOeUu+aMgee7reaXtumXtCDljZXkvY0gbXNcclxuICogICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbiAqIEBkZXNjcmlwdGlvbiBcclxuICogICAgICAgICAgICAgIOWKqOeUu+mSqeWtkOWGheeahGRpcmVjdGlvbuaYr+eUqOadpeWIpOaWremhtemdouWIh+aNoueahOaWueWQkeeahCBUT09MROihqOekuuiAgeeahOmhtemdouimgeWHuuadpeS6hiBUT05FV+ihqOekuuaWsOmhtemdouimgei/m+adpe+8jElOSVQg6KGo56S65Yid5aeL5YyWXHJcbiAqIEByZXR1cm5zIHsqfVxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlUGFnZXIob3B0cyA9IHt9KSB7XHJcbiAgICBpZiAob3B0cy5hbmltYXRpb24gJiYgIShvcHRzLnRyYW5zaXRpb25Hcm91cHx8b3B0cy5jc3NUcmFuc2l0aW9uR3JvdXApKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IFBhZ2VyRXJyb3IoJ3lvdSBzaG91bGQgcHJvdmlkZSBSZWFjdFRyYW5zaXRpb25Hcm91cCB0byB0cmFuc2l0aW9uR3JvdXAgb3B0aW9uJyk7XHJcbiAgICB9XHJcbiAgICBsZXQgVHJhbnNpdGlvbkdyb3VwID0gb3B0cy50cmFuc2l0aW9uR3JvdXA7XHJcbiAgICBsZXQgQ3NzVHJhbnNpdGlvbkdyb3VwID0gb3B0cy5jc3NUcmFuc2l0aW9uR3JvdXA7XHJcbiAgICBsZXQgY3NzID0gb3B0cy5jc3MgfHwge307XHJcbiAgICBsZXQgYW5pbWF0aW9uT2JqID0gb3B0cy5hbmltYXRpb24gfHwge307XHJcbiAgICBsZXQgZHVyYXRpb24gPSB0eXBlb2Ygb3B0cy5kdXJhdGlvbiAhPSAndW5kZWZpbmVkJyA/IG9wdHMuZHVyYXRpb24gOiAzMDA7XHJcbiAgICBsZXQgZGlyZWN0aW9uID0gRElSRUNUSU9OLklOSVQ7XHJcbiAgICBsZXQgbG9ja1RhcmdldD1vcHRzLmxvY2tUYXJnZXR8fGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07Ly/pu5jorqTplIFib2R55YWD57SgXHJcbiAgICBsZXQgQ29udGFpbmVyID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xyXG4gICAgICAgIG5hbWU6ICdDb250YWluZXInLFxyXG4gICAgICAgIGNvbXBvbmVudFdpbGxNb3VudCgpe1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY29tcG9uZW50RGlkTW91bnQoKXtcclxuICAgICAgICAgICAgbGV0IHBhZ2UgPSB0aGlzLnByb3BzLnBhZ2U7XHJcbiAgICAgICAgICAgIHRoaXMuZWwgPSBSZWFjdERPTS5maW5kRE9NTm9kZSh0aGlzKTtcclxuICAgICAgICAgICAgdXRpbC5pc0Z1bmN0aW9uKGFuaW1hdGlvbk9iai5iZWZvcmVFbnRlcikgJiYgb3B0cy5lbmFibGVBbmltYXRpb24gJiYgYW5pbWF0aW9uT2JqLmJlZm9yZUVudGVyKHRoaXMuZWwsIGRpcmVjdGlvbiwgcGFnZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb21wb25lbnRXaWxsRW50ZXIoZG9uZSl7XHJcbiAgICAgICAgICAgIGxldCBwYWdlID0gdGhpcy5wcm9wcy5wYWdlO1xyXG4gICAgICAgICAgICB2YXIgX2RvbmUgPSAoKT0+IHtcclxuICAgICAgICAgICAgICAgIF9kb25lID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGRvbmUoKTtcclxuICAgICAgICAgICAgICAgIHV0aWwuaXNGdW5jdGlvbihhbmltYXRpb25PYmouYWZ0ZXJFbnRlcikgJiYgYW5pbWF0aW9uT2JqLmFmdGVyRW50ZXIodGhpcy5lbCwgZGlyZWN0aW9uLCBwYWdlKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKHV0aWwuaXNGdW5jdGlvbihhbmltYXRpb25PYmouZW50ZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBhbmltYXRpb25PYmouZW50ZXIodGhpcy5lbCwgZGlyZWN0aW9uLCBfZG9uZSwgcGFnZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfZG9uZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb21wb25lbnRXaWxsVW5tb3VudCgpe1xyXG4gICAgICAgICAgICBsZXQgcGFnZSA9IHRoaXMucHJvcHMucGFnZTtcclxuICAgICAgICAgICAgdXRpbC5pc0Z1bmN0aW9uKGFuaW1hdGlvbk9iai5hZnRlckxlYXZlKSAmJiBvcHRzLmVuYWJsZUFuaW1hdGlvbiAmJiBhbmltYXRpb25PYmouYWZ0ZXJMZWF2ZSh0aGlzLmVsLCBkaXJlY3Rpb24sIHBhZ2UpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY29tcG9uZW50V2lsbExlYXZlKGRvbmUpe1xyXG4gICAgICAgICAgICBsZXQgcGFnZSA9IHRoaXMucHJvcHMucGFnZTtcclxuICAgICAgICAgICAgdXRpbC5pc0Z1bmN0aW9uKGFuaW1hdGlvbk9iai5iZWZvcmVMZWF2ZSkgJiYgYW5pbWF0aW9uT2JqLmJlZm9yZUxlYXZlKHRoaXMuZWwsIGRpcmVjdGlvbiwgcGFnZSk7XHJcbiAgICAgICAgICAgIHV0aWwuaXNGdW5jdGlvbihhbmltYXRpb25PYmoubGVhdmUpID8gYW5pbWF0aW9uT2JqLmxlYXZlKHRoaXMuZWwsIGRpcmVjdGlvbiwgZG9uZSwgcGFnZSkgOiBkb25lKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZW5kZXIoKXtcclxuICAgICAgICAgICAgcmV0dXJuIDxkaXYgc3R5bGU9e3RoaXMucHJvcHMuc3R5bGV9IGNsYXNzTmFtZT17dGhpcy5wcm9wcy5jbGFzc05hbWV9Pnt0aGlzLnByb3BzLmNoaWxkcmVufTwvZGl2PjtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIGxldCBQYWdlciA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcclxuICAgICAgICBuYW1lOiAnUGFnZXInLFxyXG4gICAgICAgIGdldEluaXRpYWxTdGF0ZSgpe1xyXG4gICAgICAgICAgICB0aGlzLnN0YWNrID0gW107XHJcbiAgICAgICAgICAgIHJldHVybiB7cGFnZTogbnVsbCwgY29tcG9uZW50OiBudWxsfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbXBvbmVudERpZE1vdW50KCl7XHJcbiAgICAgICAgICAgIHRoaXMuX2NoYW5nZVBhZ2UodGhpcy5wcm9wcy5wYWdlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNob3VsZENvbXBvbmVudFVwZGF0ZShuZXh0UHJvcHMsIG5leHRTdGF0ZSl7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGFuZ2VQYWdlKG5leHRTdGF0ZS5wYWdlIHx8IG5leHRQcm9wcy5wYWdlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHN3aXRjaFBhZ2UocGFnZSwgY29tcG9uZW50KXtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICBwYWdlLFxyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgX2NoYW5nZVBhZ2UocGFnZSl7XHJcbiAgICAgICAgICAgIGxldCBsZW4gPSB0aGlzLnN0YWNrLmxlbmd0aDtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2tbbGVuIC0gMV0gPT0gcGFnZSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICBsZXQgaW5kZXggPSB0aGlzLnN0YWNrLmluZGV4T2YocGFnZSk7XHJcbiAgICAgICAgICAgIGlmIChpbmRleCAhPSAtMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFjay5zcGxpY2UoaW5kZXggKyAxKTtcclxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IERJUkVDVElPTi5UT09MRDsvL29sZCB3aWxsIGRpc3BsYXlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaChwYWdlKTtcclxuICAgICAgICAgICAgICAgIC8v5paw55qE5Ye6546wXHJcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSBESVJFQ1RJT04uVE9ORVc7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGFjay5sZW5ndGggPD0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IERJUkVDVElPTi5JTklUO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVuZGVyKCl7XHJcbiAgICAgICAgICAgIGxldCBDb21wb25lbnQgPSB0aGlzLnByb3BzLmNvbXBvbmVudDtcclxuICAgICAgICAgICAgbGV0IHN0eWxlID0ge1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6ICcxMDAlJyxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogJzEwMCUnLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogMCxcclxuICAgICAgICAgICAgICAgIHJpZ2h0OiAwLFxyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZSdcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuc3R5bGUpIHtcclxuICAgICAgICAgICAgICAgIHV0aWwuZXh0ZW5kKHN0eWxlLCB0aGlzLnByb3BzLnN0eWxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgY2hpbGQgPSA8Q29udGFpbmVyIGtleT17dGhpcy5wcm9wcy5wYWdlfSBwYWdlPXt0aGlzLnByb3BzLnBhZ2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3N0eWxlfSBjbGFzc05hbWU9e2Nzcy50cmFuc2l0aW9ufHwnJ30+XHJcbiAgICAgICAgICAgICAgICB7Q29tcG9uZW50fVxyXG4gICAgICAgICAgICA8L0NvbnRhaW5lcj47XHJcbiAgICAgICAgICAgIGlmIChvcHRzLmVuYWJsZUFuaW1hdGlvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKENzc1RyYW5zaXRpb25Hcm91cCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjbGFzc05hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PSBESVJFQ1RJT04uVE9ORVcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lID0gY3NzLmZvcndhcmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gRElSRUNUSU9OLlRPT0xEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IGNzcy5iYWNrd2FyZDtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxDc3NUcmFuc2l0aW9uR3JvdXAgY29tcG9uZW50PVwiZGl2XCIgdHJhbnNpdGlvbk5hbWU9e2NsYXNzTmFtZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uRW50ZXJUaW1lb3V0PXtkdXJhdGlvbn0gdHJhbnNpdGlvbkxlYXZlVGltZW91dD17ZHVyYXRpb259PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7Y2hpbGR9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9Dc3NUcmFuc2l0aW9uR3JvdXA+XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFRyYW5zaXRpb25Hcm91cCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoPFRyYW5zaXRpb25Hcm91cCBjb21wb25lbnQ9J2Rpdicgc3R5bGU9e3N0eWxlfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAge2NoaWxkfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvVHJhbnNpdGlvbkdyb3VwPik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBDb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ29tcG9uZW50O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgUGFnZXIubG9jaz0oKT0+e1xyXG4gICAgICAgIGlmKGRpcmVjdGlvbj09RElSRUNUSU9OLklOSVQpe1xyXG4gICAgICAgICAgICBQYWdlci51bmxvY2soKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsb2NrVGFyZ2V0LnN0eWxlLnBvaW50ZXJFdmVudHM9J25vbmUnO1xyXG4gICAgfTtcclxuICAgIFBhZ2VyLnVubG9jaz0oKT0+e1xyXG4gICAgICAgIGxvY2tUYXJnZXQuc3R5bGUucG9pbnRlckV2ZW50cz0nYXV0byc7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBhZ2VyO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAgIGNyZWF0ZVBhZ2VyLFxyXG4gICAgRElSRUNUSU9OXHJcbn07XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvcGFnZXIuanNcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMV9fO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogZXh0ZXJuYWwgXCJyZWFjdFwiXG4gKiogbW9kdWxlIGlkID0gMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwIDFcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMl9fO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogZXh0ZXJuYWwgXCJyZWFjdC1kb21cIlxuICoqIG1vZHVsZSBpZCA9IDJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMCAxXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==